<!DOCTYPE html>
<html lang="en">

<head>
    <title>demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!--<link rel="stylesheet" href="https://code.jquery.com/ui/resources/demos/style.css">-->

    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">-->
    <link rel="stylesheet" href="cal.css">
    <!--<link rel="stylesheet" href="app.css">-->
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700'>

</head>

<body>
    <!-- partial:index.partial.html -->
    <div class="app-container">
        <div class="app-header">
            <div class="app-header-left">
                <span class="app-icon"></span>
                <p class="app-name" id="Roll_no"></p>
                <div class="search-wrapper">
                    <input class="search-input" type="text" placeholder="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-search" viewBox="0 0 24 24">
                        <defs></defs>
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                </div>
            </div>
            <div class="app-header-right">
                <div class="dropdown profile-btn">
                    <button class="dropbtn" onclick="myFunction();">
                        <img src="https://assets.codepen.io/3306515/IMG_2025.jpg" />
                        <span id="Name"></span>
                    </button>
                    <div class="dropdown-content" id="myDropdown">
                        <a href="form.html">Profile</a>
                        <a id="btn-logout" href="index.html">Logout</a>
                    </div>
                </div>
            </div>
            <button class="messages-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-circle">
                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" />
                </svg>
            </button>
        </div>
        <div class="app-content">
            <div class="app-sidebar">
                <a href="ui.html" class="app-sidebar-link ">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" />
                    </svg>
                </a>
                <a href="attendance.html" class="app-sidebar-link">
                    <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-pie-chart" viewBox="0 0 24 24">
                        <defs />
                        <path d="M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z" />
                    </svg>
                </a>
                <a href="" class="app-sidebar-link active" >
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                </a>
                <a href="https://feepayr.com/" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sidebar">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                        <defs />
                    </svg>
                </a>
            </div>
            <div class="projects-section">
                <div id="datepicker" style="margin-top: 60vm;"></div>
            </div>
            <div class="messages-section">
                <div class="wrapper">
                    <div class="pie-charts">
                        <div class="pieID--micro-skills pie-chart--wrapper">
                            <div class="pie-chart">
                                <div class="pie-chart__pie"></div>
                                <ul class="pie-chart__legend">
                                    <li><em>Lectures Attended</em><span id="present">6</span></li>
                                    <li><em>Lectures Missed</em><span id="absent"></span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <p style="text-align: center;" id="lectures">No Data Available</p>
                </div>
            </div>
        </div>
    </div>

    <!-- partial -->
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-storage.js"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <!--<script src="https://code.jquery.com/jquery-1.12.4.js"></script>-->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script type="text/javascript" src="cal.js"></script>
    <script type="text/javascript" src="main.js"></script>
    <!--<script type="text/javascript" src="test.js"></script>-->
    <script>
        firebase.auth().onAuthStateChanged(function(user) {
            if (!user) {
                window.location.href = "index.html";
            } else {
                var userID = firebase.auth().currentUser.uid;
                firebase.database().ref().child('Users/' + userID).once('value').then(function(snapshot) {
                    var curuser = snapshot.val();
                    console.log(curuser.Roll_no);
                    document.getElementById("Roll_no").innerHTML = curuser.Roll_no;
                    document.getElementById("Name").innerHTML = curuser.Name;
                    var year = curuser.Semester;
                    var division = curuser.Division;
                    var dept = "";
                    var roll = curuser.Roll_no;
                    if (year == 1) {
                        dept = "Fy"
                    } else {
                        dept = curuser.Department;
                    }

                    $(function() {
                        $("#datepicker").datepicker({
                            dateformat: "yyyy-mm-dd"
                        });
                        //$.datepicker.formatDate("yy-mm-dd",new Date(2007,1-1,26));
                        $("#datepicker").on("change", function() {
                            var selected = $(this).val();
                            console.log(selected);

                            var date1 = selected;
                            var arr = date1.split('/');
                            var date = arr[1];
                            var month = arr[0];
                            var year1 = arr[2];
                            console.log(month);

                            var finaldate = date + month + year1;
                            console.log(finaldate);
                     
                            var select = date+'/'+month+'/'+year1;
                            /*if (!firebase.database().ref().child('Classroom').child(year).child(dept).child(division).child(roll).child('Ttattendance').child(finaldate)) {*/
                        firebase.database().ref().child('Classroom').child(year).child(dept).child(division).child(roll).child('Ttattendance').child(finaldate).once('value').then(function(snapshot) {
                            var arr1 = snapshot.val();
                            console.log(arr1);
                            var arr2 = arr1.split(',');
                            var present = arr2.length;
                            var absent = 6 - present;
                            document.getElementById("present").innerHTML=present;
                            document.getElementById("absent").innerHTML=absent;
                            document.getElementById("lectures").innerHTML=arr1+'<br><br>'+select;
                        })
                  //  }
                          /*  else{
                                 document.getElementById("lectures").innerHTML="No Data Available";
                        }*/
                })
                   })
                    });
            }
        });

    </script>
<script>
    $(function() {
                        $("#datepicker").datepicker({
                            dateformat: "yyyy-mm-dd"
                        });
                        //$.datepicker.formatDate("yy-mm-dd",new Date(2007,1-1,26));
                        $("#datepicker").on("change", function() {
                            var selected = $(this).val();
                            console.log(selected);

                            var date1 = selected;
                            var arr = date1.split('/');
                            var date = arr[1];
                            var month = arr[0];
                            var year = arr[2];
                            console.log(month);

                            var finaldate = date + month + year;
                            console.log(finaldate);
                        })
                    });
    </script>
</body>

</html>
